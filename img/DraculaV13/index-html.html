<!DOCTYPE html>
<html lang="fr">
<head>



<!-- Styles am√©lior√©s pour les √©crans titre et Transylvanie (√† ajouter dans la section style) -->
<style>

  #audio-init-button {
    display: none !important;
  }

  /* Styles am√©lior√©s pour l'√©cran titre et la page Transylvanie */
  
  /* Animation de sang qui goutte */
  @keyframes bloodDrip {
    0% { transform: scaleY(0); opacity: 0; }
    30% { opacity: 1; }
    100% { transform: scaleY(1); opacity: 0.8; }
  }
  
  /* Animation de battement pour le titre */
  @keyframes heartbeat {
    0% { transform: scale(1); }
    5% { transform: scale(1.05); }
    10% { transform: scale(1); }
    15% { transform: scale(1.05); }
    20% { transform: scale(1); }
    100% { transform: scale(1); }
  }
  
  /* Animation pour le brouillard */
  @keyframes fogMove {
    0% { transform: translateX(-5%) translateY(0); opacity: 0.3; }
    50% { transform: translateX(5%) translateY(-5%); opacity: 0.4; }
    100% { transform: translateX(-5%) translateY(0); opacity: 0.3; }
  }
  
  /* Animation pour l'apparition des textes */
  @keyframes textReveal {
    0% { opacity: 0; transform: translateY(20px); }
    100% { opacity: 1; transform: translateY(0); }
  }
  
  /* Animation pour le bouton pulsant */
  @keyframes buttonPulse {
    0% { box-shadow: 0 0 10px rgba(128, 0, 0, 0.5); }
    50% { box-shadow: 0 0 20px rgba(192, 0, 0, 0.7); }
    100% { box-shadow: 0 0 10px rgba(128, 0, 0, 0.5); }
  }

  #passage-1 {
    position: relative;
    max-width: 1000px;
    margin: 0 auto;
    padding: 40px 20px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  
  /* Effet de vignette pour assombrir les bords */
  #passage-1::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.7) 100%);
    pointer-events: none;
    z-index: -1;
  }

  /* Titre principal am√©lior√© */
  #passage-1 .title {
    font-size: 5em;
    text-align: center;
    color: #b00;
    text-shadow: 
      0 0 10px rgba(0,0,0,0.8),
      0 0 30px rgba(120,0,0,0.6),
      0 0 50px rgba(128,0,0,0.4);
    letter-spacing: 3px;
    font-variant: small-caps;
    font-family: 'Trajan Pro', 'Times New Roman', serif;
    margin-bottom: 20px;
    position: relative;
    animation: heartbeat 5s infinite;
  }
  
  /* Effet de sang qui goutte depuis le titre */
  #passage-1 .title::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 30px;
    bottom: -30px;
    left: 0;
    background: linear-gradient(180deg, #b00, transparent);
    transform-origin: top;
    animation: bloodDrip 5s ease-in-out infinite;
  }
  
  #passage-1 .author {
    font-size: 1.4em;
    text-align: center;
    font-style: italic;
    margin: 30px 0;
    color: #aaa;
    opacity: 0.8;
    animation: textReveal 2s ease-out forwards;
    animation-delay: 0.5s;
    opacity: 0;
  }
  
  /* Bouton am√©lior√© pour l'√©cran titre */
  #passage-1 .start-button {
    width: 300px;
    margin: 60px auto 0;
    padding: 18px 30px;
    background: linear-gradient(to bottom, #900, #500);
    color: #fff;
    text-align: center;
    text-decoration: none;
    border-radius: 5px;
    font-size: 1.4em;
    cursor: pointer;
    border: 1px solid #700;
    position: relative;
    overflow: hidden;
    animation: buttonPulse 3s infinite;
    transition: all 0.5s ease;
    font-family: 'Trajan Pro', 'Times New Roman', serif;
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  
  #passage-1 .start-button:hover {
    background: linear-gradient(to bottom, #a00, #600);
    transform: translateY(-5px) scale(1.05);
    box-shadow: 
      0 10px 30px rgba(0,0,0,0.5),
      0 0 30px rgba(128,0,0,0.5);
  }
  
  /* Effet brillant sur le bouton au survol */
  #passage-1 .start-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      to right,
      transparent 0%,
      rgba(255,255,255,0.2) 50%,
      transparent 100%
    );
    transition: left 0.7s ease;
  }
  
  #passage-1 .start-button:hover::before {
    left: 100%;
  }
  
  /* √âcran de Transylvanie am√©lior√© */
  #passage-2 {
    max-width: 1000px;
    margin: 0 auto;
    padding: 30px;
    position: relative;
    z-index: 10;
  }
  
  /* Effet de brouillard anim√© pour Transylvanie */
  .fog-effect {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
      url('https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/main/img/fog.png');
    background-size: cover;
    opacity: 0.3;
    pointer-events: none;
    z-index: -1;
    animation: fogMove 60s ease-in-out infinite;
  }
  
  #passage-2 .title {
    font-size: 3.5em;
    text-align: center;
    color: #a00;
    text-shadow: 
      0 0 10px rgba(0,0,0,0.8),
      0 0 20px rgba(120,0,0,0.6);
    letter-spacing: 3px;
    font-variant: small-caps;
    margin-bottom: 30px;
    font-family: 'Trajan Pro', 'Times New Roman', serif;
    padding-bottom: 15px;
    position: relative;
  }
  
  /* Ligne d√©corative sous le titre de Transylvanie */
  #passage-2 .title::after {
    content: '';
    position: absolute;
    width: 60%;
    height: 1px;
    bottom: 0;
    left: 20%;
    background: linear-gradient(to right, transparent, #a00, transparent);
  }
  
  /* Conteneur pour les paragraphes avec effet de parchemin */
  .parchment-container {
    background-color: rgba(0, 0, 0, 0.6);
    border: 1px solid #500;
    box-shadow: 
      0 0 20px rgba(0,0,0,0.5),
      inset 0 0 15px rgba(128,0,0,0.2);
    border-radius: 5px;
    padding: 30px;
    margin: 20px 0;
    position: relative;
    overflow: hidden;
  }
  
  /* Style am√©lior√© pour les paragraphes */
  #passage-2 p {
    font-size: 1.1em;
    line-height: 1.7;
    margin-bottom: 20px;
    text-align: justify;
    color: #ddd;
    font-family: 'Georgia', serif;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
    position: relative;
    animation: textReveal 1s ease-out forwards;
    opacity: 0;
  }
  
  /* Animation s√©quentielle pour les paragraphes */
  #passage-2 p:nth-child(1) { animation-delay: 0.3s; }
  #passage-2 p:nth-child(2) { animation-delay: 0.6s; }
  #passage-2 p:nth-child(3) { animation-delay: 0.9s; }
  #passage-2 p:nth-child(4) { animation-delay: 1.2s; }
  #passage-2 p:nth-child(5) { animation-delay: 1.5s; }
  #passage-2 p:nth-child(6) { animation-delay: 1.8s; }
  
  /* Premi√®re lettre stylis√©e */
  #passage-2 p:first-of-type::first-letter {
    font-size: 3.5em;
    float: left;
    line-height: 0.8;
    margin-right: 8px;
    color: #a00;
    font-family: 'Times New Roman', serif;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
  }
  
  /* Bouton am√©lior√© pour continuer */
  #passage-2 .continue-button {
    width: 280px;
    margin: 40px auto 20px;
    padding: 16px 25px;
    background: linear-gradient(to bottom, #800, #400);
    color: #fff;
    text-align: center;
    text-decoration: none;
    border-radius: 5px;
    font-size: 1.3em;
    cursor: pointer;
    border: 1px solid #600;
    position: relative;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    transition: all 0.4s ease;
    animation: buttonPulse 3s infinite;
    animation-delay: 2s;
  }
  
  #passage-2 .continue-button:hover {
    background: linear-gradient(to bottom, #900, #500);
    transform: translateY(-3px);
    box-shadow: 
      0 8px 20px rgba(0,0,0,0.4),
      0 0 20px rgba(128,0,0,0.4);
  }
  
  /* Effet brillant sur le bouton au survol */
  #passage-2 .continue-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      to right,
      transparent 0%,
      rgba(255,255,255,0.2) 50%,
      transparent 100%
    );
    transition: left 0.7s ease;
  }
  
  #passage-2 .continue-button:hover::before {
    left: 100%;
  }
  
  /* Effet de vignette pour assombrir les bords */
  .vignette-effect {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.7) 100%);
    pointer-events: none;
    z-index: -1;
  }
  
  /* Barre de narration am√©lior√©e */
  .narration-bar {
    text-align: center;
    margin: 0 auto 30px;
    padding: 15px;
    position: relative;
    border-radius: 5px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  /* Bouton de narration am√©lior√© */
  .narration-button {
    background: linear-gradient(to bottom, #700, #400);
    color: #fff;
    border: 1px solid #800;
    border-radius: 5px;
    padding: 12px 20px;
    cursor: pointer;
    font-size: 1.1em;
    display: inline-flex;
    align-items: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.4);
    transition: all 0.3s ease;
    font-family: 'Georgia', serif;
  }
  
  .narration-button:hover {
    background: linear-gradient(to bottom, #900, #500);
    transform: translateY(-3px);
    box-shadow: 
      0 8px 20px rgba(0,0,0,0.5),
      0 0 15px rgba(255,0,0,0.3);
  }
  
  .narration-button span {
    margin-right: 10px;
  }
  
  /*Ajouter ce style dans la section head de votre HTML */
<style id="back-button">
  #bouton-revenir {
    position: fixed;
    bottom: 20px;
    left: 20px;
    padding: 10px 15px;
    background: linear-gradient(to bottom, #600, #300);
    color: #fff;
    text-align: center;
    text-decoration: none;
    border-radius: 5px;
    font-size: 1.1em;
    cursor: pointer;
    border: 1px solid #800;
    z-index: 9000;
    font-family: 'Georgia', serif;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
    transition: all 0.3s ease;
    /* Assurer que le bouton est visible */
    display: block;
    opacity: 0.9;
  }

  #bouton-revenir:hover {
    background: linear-gradient(to bottom, #800, #500);
    transform: translateY(-3px) scale(1.05);
    box-shadow: 
      0 8px 20px rgba(0,0,0,0.5),
      0 0 20px rgba(128,0,0,0.5);
    opacity: 1;
  }

  #bouton-revenir:active {
    transform: translateY(1px);
    box-shadow: 0 2px 10px rgba(0,0,0,0.4);
  }

  /* Effet brillant sur le bouton au survol */
  #bouton-revenir::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      to right,
      transparent 0%,
      rgba(255,255,255,0.2) 50%,
      transparent 100%
    );
    transition: left 0.7s ease;
  }

  #bouton-revenir:hover::before {
    left: 100%;
  }
</style>

<!-- Script pour ajouter les √©l√©ments visuels am√©lior√©s -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Ajouter l'effet de brouillard pour Transylvanie
    const fogEffect = document.createElement('div');
    fogEffect.className = 'fog-effect';
    document.body.appendChild(fogEffect);
    
    // Ajouter l'effet de vignette
    const vignetteEffect = document.createElement('div');
    vignetteEffect.className = 'vignette-effect';
    document.body.appendChild(vignetteEffect);
    
    // Ajouter le conteneur de parchemin pour les paragraphes de Transylvanie
    const passage2 = document.getElementById('passage-2');
    if (passage2) {
      const title = passage2.querySelector('.title');
      const paragraphs = passage2.querySelectorAll('p');
      const continueButton = passage2.querySelector('.continue-button');
      
      // Cr√©er le conteneur de parchemin
      const parchmentContainer = document.createElement('div');
      parchmentContainer.className = 'parchment-container';
      
      // D√©placer les paragraphes dans le conteneur de parchemin
      paragraphs.forEach(p => {
        passage2.removeChild(p);
        parchmentContainer.appendChild(p);
      });
      
      // Ajouter le conteneur apr√®s le titre
      if (title && title.nextSibling) {
        passage2.insertBefore(parchmentContainer, title.nextSibling);
      } else {
        passage2.appendChild(parchmentContainer);
      }
      
      // Cr√©er la barre de narration
      const narrationBar = document.createElement('div');
      narrationBar.className = 'narration-bar';
      
      // Cr√©er le bouton de narration
      const narrationButton = document.createElement('button');
      narrationButton.className = 'narration-button';
      narrationButton.id = 'narrationButton';
      narrationButton.innerHTML = '<span>üîä</span> √âcouter la narration';
      
      // Ajouter le bouton √† la barre
      narrationBar.appendChild(narrationButton);
      
      // Ajouter la barre apr√®s le titre
      passage2.insertBefore(narrationBar, title.nextSibling);
      
      // R√©attacher le bouton continuer √† la fin
      if (continueButton) {
        passage2.appendChild(continueButton);
      }
    }
  });
</script>
  <meta charset="UTF-8">
  <title>Le Ch√¢teau de Dracula</title>
  <style>
  
    /* Styles de base */
    body { 
      background-color: #000; 
      color: #ccc;
      font-family: 'Georgia', serif;
      font-size: 1.1em;
      line-height: 1.6;
      margin: 0;
      padding: 0;
    }

    /* Style pour l'√©l√©ment scene-background */
    #scene-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -5; /* Derri√®re le contenu */
      pointer-events: none;
    }
    
    /* Style pour l'image dans scene-background */
    #scene-background img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.7;
    }

    .passage {
      max-width: 800px;
      margin: 30px auto;
      padding: 20px;
      position: relative;
      z-index: 10; /* Au-dessus du fond */
    }
    
    .hidden {
      display: none;
    }
    
    .title {
      font-size: 3em;
      text-align: center;
      color: #800;
      text-shadow: 2px 2px 4px #000;
      letter-spacing: 3px;
      font-variant: small-caps;
      margin-bottom: 20px;
    }
    
    .author {
      text-align: center;
      font-style: italic;
      margin-bottom: 30px;
      opacity: 0.8;
    }
    
    .start-button, .choice-button, .continue-button {
      display: block;
      width: 250px;
      margin: 30px auto;
      padding: 15px 25px;
      background: linear-gradient(to bottom, #600, #300);
      color: #fff;
      text-align: center;
      text-decoration: none;
      border-radius: 5px;
      font-size: 1.2em;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      position: relative;
      z-index: 20; /* Pour s'assurer que les boutons sont cliquables */
    }
    
    .start-button:hover, .choice-button:hover, .continue-button:hover {
      background: linear-gradient(to bottom, #800, #500);
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
    }
    
    .choices-title {
      text-align: center;
      font-weight: bold;
      margin: 40px 0 20px;
      font-size: 1.2em;
      color: #800;
    }
    
    .choices {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
    }
    
    .choices a {
      display: block;
      padding: 15px 25px;
      background-color: #300;
      color: #fff;
      text-decoration: none;
      border-radius: 5px;
      transition: all 0.3s ease;
      border: 1px solid #500;
      min-width: 250px;
      text-align: center;
    }
    
    .choices a:hover {
      background-color: #600;
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
    }
    
    #sidebar {
      position: fixed;
      left: 0;
      top: 0;
      height: 100%;
      z-index: 9999;
    }
    
    .sidebar-toggle {
      background-color: #500;
      color: #fff;
      padding: 10px 15px;
      border: none;
      cursor: pointer;
      font-size: 1em;
      margin: 10px;
      border-radius: 5px;
      transition: background-color 0.3s;
    }
    
    .sidebar-toggle:hover {
      background-color: #800;
    }
    
    .sidebar-content {
      width: 250px;
      background-color: #000;
      color: #ccc;
      height: 100%;
      padding: 20px;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
      transform: translateX(-270px);
      transition: transform 0.4s ease;
      overflow-y: auto;
    }
    
    .sidebar-content.open {
      transform: translateX(0);
    }
    
    .sidebar-content h3 {
      color: #800;
      margin-top: 20px;
      margin-bottom: 10px;
    }
    
    .sidebar-content ul {
      list-style: none;
      padding-left: 0;
      margin: 0 0 15px 0;
    }
    
    .sidebar-content li {
      margin-bottom: 5px;
    }

    /* Style pour les d√©s */    
    .die {
      display: inline-block;
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #400, #800);
      color: #fff;
      text-align: center;
      line-height: 50px;
      margin: 0 10px;
      border-radius: 5px;
      font-weight: bold;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }
    
    /* Animation pour le lancer de d√© */
    @keyframes diceRoll {
      0% { transform: rotate(0) scale(1); }
      25% { transform: rotate(-10deg) scale(1.1); }
      75% { transform: rotate(10deg) scale(1.1); }
      100% { transform: rotate(0) scale(1); }
    }
    
    .die.rolling {
      animation: diceRoll 0.3s ease-in-out;
      background: linear-gradient(135deg, #800, #c00);
    }
    
    /* Style pour l'encadr√© de texte */
    .text-frame {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: rgba(0, 0, 0, 0.85);
      border: 2px solid #500;
      box-shadow: 0 0 20px rgba(128, 0, 0, 0.5), inset 0 0 15px rgba(128, 0, 0, 0.3);
      height: 200px;
      z-index: 100;
      padding: 0;
      transition: height 0.4s ease;
      overflow: hidden;
      display: none;
    }
    
    .text-frame-header {
      height: 30px;
      background-color: #300;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 10px;
      border-bottom: 1px solid #800;
      cursor: pointer;
    }

    .text-frame-title {
      color: #fff;
      font-variant: small-caps;
      letter-spacing: 1px;
      font-size: 1em;
    }

    .text-frame-controls {
      display: flex;
      gap: 10px;
    }

    .text-frame-controls button {
      background: none;
      border: none;
      color: #aaa;
      cursor: pointer;
      transition: color 0.3s;
      font-size: 1.2em;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .text-frame-controls button:hover {
      color: #fff;
    }

    .text-content {
      height: calc(100% - 30px);
      overflow-y: auto;
      padding: 15px 25px;
      color: #ccc;
      font-family: 'Georgia', serif;
      line-height: 1.6;
      scrollbar-width: thin;
      scrollbar-color: #500 #000;
    }
    
    .image-container {
      position: relative;
      width: 100%;
      height: calc(100vh - 230px);
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: height 0.4s ease;
    }

    /* AM√âLIORATIONS POUR L'√âCRAN DE CR√âATION DE JONATHAN HARKER */
    
    /* Layout deux colonnes pour cr√©ation de personnage */
    .character-creation-layout {
      display: flex;
      justify-content: space-between;
      position: relative;
      margin-top: 20px;
    }

    /* Colonne de stats - √† gauche */
    .stats-column {
      width: 55%;
      background-color: rgba(0, 0, 0, 0.7);
      border: 1px solid #800;
      box-shadow: 0 0 20px rgba(128, 0, 0, 0.3);
      padding: 25px;
      border-radius: 5px;
    }

    /* Tableau des caract√©ristiques am√©lior√© */
    .stats-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 10px;
      margin: 20px 0;
    }

    .stats-table td {
      padding: 8px;
      vertical-align: middle;
    }

    .stats-table td:first-child {
      width: 120px;
      font-weight: bold;
      font-size: 1.1em;
      color: #a00;
      text-shadow: 1px 1px 2px #000;
    }

    .stats-header {
      text-align: center;
      font-size: 1.4em;
      margin-bottom: 20px;
      color: #b00;
      text-shadow: 2px 2px 4px #000;
    }

    /* Style am√©lior√© pour les d√©s */
    .creation-die {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #500, #900);
      color: #fff;
      font-size: 1.8em;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      margin: 0 auto;
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
      text-shadow: 1px 1px 3px #000;
      position: relative;
    }

    /* Colonne de portrait - √† droite */
    .portrait-column {
      width: 40%;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .portrait-frame {
      position: relative;
      width: 100%;
      max-width: 280px;
      margin-bottom: 20px;
    }

    .portrait-frame::before {
      content: '';
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      border: 2px solid #700;
      box-shadow: 0 0 20px rgba(128, 0, 0, 0.5);
      z-index: -1;
      background-color: rgba(0, 0, 0, 0.4);
    }

    .portrait-image {
      width: 100%;
      height: auto;
      display: block;
      border: 1px solid #500;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
    }

    /* Style am√©lior√© pour les boutons de lancer */
    .roll-button {
      background: linear-gradient(to bottom, #700, #400);
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 8px 15px;
      font-size: 0.9em;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 0 auto;
      display: block;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    }

    .roll-button:hover {
      background: linear-gradient(to bottom, #900, #600);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(128, 0, 0, 0.4);
    }

    .roll-button:active {
      transform: translateY(1px);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }

    /* Section d'argent am√©lior√©e */
    .money-section {
      background-color: rgba(0, 0, 0, 0.7);
      border: 1px solid #800;
      box-shadow: 0 0 20px rgba(128, 0, 0, 0.3);
      padding: 15px;
      border-radius: 5px;
      text-align: center;
      margin-top: 20px;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .money-title {
      font-size: 1.1em;
      color: #b00;
      margin-bottom: 10px;
    }

    .money-value-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 10px;
    }

    .money-value {
      font-size: 1.6em;
      color: #b80;
      font-weight: bold;
      text-shadow: 1px 1px 2px #000;
    }

    /* Style pour les tooltips */
    .stat-label {
      position: relative;
      display: inline-block;
      cursor: help;
    }
    
    .stat-label::after {
      content: '‚ìò';
      font-size: 0.8em;
      margin-left: 5px;
      color: #888;
    }
    
    .stat-tooltip {
      position: absolute;
      background-color: rgba(0, 0, 0, 0.9);
      color: #ccc;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #700;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
      width: 200px;
      font-size: 0.9em;
      z-index: 100;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s;
      left: 120%;
      top: -50%;
    }
    
    .stat-label:hover .stat-tooltip {
      visibility: visible;
      opacity: 1;
    }

    /* Animation pour l'apparition du portrait */
    @keyframes portraitFadeIn {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }
    
    /* Am√©lioration pour le bouton de d√©marrage */
    .choice-button {
      background: linear-gradient(to bottom, #600, #300);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
    }
    
    .choice-button:hover {
      background: linear-gradient(to bottom, #800, #500);
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 10px 25px rgba(128, 0, 0, 0.5);
    }
    
    /* Am√©lioration pour Dracula */
    .dracula-image {
      max-width: 400px;
      height: auto;
      animation: draculaFadeIn 1.5s ease-out forwards;
    }
    
    @keyframes draculaFadeIn {
      0% { opacity: 0; transform: scale(0.8) translateX(50px); }
      100% { opacity: 1; transform: scale(1) translateX(0); }
    }
	
	#bouton-revenir {
    position: fixed;
    bottom: 20px;
    left: 20px;
    padding: 10px 15px;
    background-color: #600; /* Couleur rouge fonc√© Dracula */
    color: #ffffff;          /* Texte blanc */
    font-size: 16px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    z-index: 9999;          /* S'assure que le bouton est devant tout */
    box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    transition: background-color 0.2s ease-in-out;
  }

  #bouton-revenir:hover {
    background-color: #900; /* Rouge un peu plus vif au survol */
  }
	
  </style>
  
</head>
<body>
  <!-- √âl√©ments pour le fond d'√©cran -->
  <div id="scene-background"></div>
  <div class="transylvania-background" id="transylvania-bg"></div>
  <div class="rain" id="rain-effect"></div>
  <div class="lightning" id="lightning-effect"></div>

  <!-- Menu lat√©ral -->
  <div id="sidebar">
    <button class="sidebar-toggle" onclick="toggleSidebar()">Menu</button>
    <div class="sidebar-content" id="sidebarContent">
      <h3>Caract√©ristiques</h3>
      <p id="player-stats">
        RAPIDIT√â : <span id="stat-rapidite">-</span><br>
        COURAGE : <span id="stat-courage">-</span><br>
        FORCE : <span id="stat-force">-</span><br>
        HABILET√â : <span id="stat-habilete">-</span><br>
        PSI : <span id="stat-psi">-</span>
      </p>
      <h3>Inventaire</h3>
      <ul id="player-inventory">
        <li>Aucun objet</li>
      </ul>
      <h3>Pouvoirs</h3>
      <ul id="player-powers">
        <li>Aucun pouvoir</li>
      </ul>
    </div>
  </div>

  <!-- √âcran titre -->
  <div id="passage-1" class="passage">
    <div class="title">Le Ch√¢teau de Dracula</div>
    <div class="author">par J.H. Brennan, adaptation interactive</div>
	
	
	  <p>Au loin, un loup hurle. Aussit√¥t, comme si le ciel lui r√©pondait, un √©clair
illumine bri√®vement la for√™t t√©n√©breuse. Puis, dans le grondement du
tonnerre, la sc√®ne est brutalement replong√©e dans l'obscurit√©. Telle la
cicatrice d'un coup de sabre sur le visage d'un g√©ant, une route d√©serte
balafre la for√™t en se faufilant parmi les arbres comme un serpent rampant vers un destin inexorable. Une pluie torrentielle cingle ce fragile
ruban, ruisselant entre les feuilles et courbant les troncs secou√©s par le
vent furieux dont les plaintes et les g√©missements √©voquent une √¢me en
d√©tresse.</p>
    <button class="start-button" onclick="showPassage('passage-2')">Commencer l'aventure</button>
  </div>

  <!-- Passage "La Transylvanie" -->
  <div id="passage-2" class="passage hidden">
    <div class="title">La Transylvanie</div>
	
        

    <p>Le cocher doit se cramponner √† ses r√™nes pour reprendre le contr√¥le de
son attelage. Le bruit du tonnerre se fond progressivement dans un vacarme assourdissant qui se
d√©compose progressivement en claquement de sabots, en cliquetis de harnais, en fracas de roues
cercl√©es de fer. Un fouet claque, des chevaux s'√©brouent. Une voiture noire appara√Æt, tanguant sur
la route comme un bateau sur la mer. Les chevaux ont l'√©cume √† la bouche, les yeux fous. Le
cocher, dont la p√®lerine flotte au vent, est un gaillard robuste, un homme capable, exp√©riment√©,
aux √©paules larges et aux mains puissantes. Et, pourtant, lui aussi para√Æt effray√©.</p>

    <p>La route se met √† monter. En s'√©levant, elle √©merge de la for√™t pour d√©boucher dans une lande
d√©sol√©e, battue par la pluie, parsem√©e de rochers dont les formes tourment√©es prennent, √†
chaque √©clair, l'aspect de fant√¥mes hideux. ‚Äî Allez, hue ! crie le cocher. Mais les chevaux n'ont
pas besoin d'√™tre encourag√©s car ils galopent d√©j√† comme s'ils avaient le diable √† leurs trousses.</p>

    <p>La route continue √† grimper de lacet en lacet, et la lueur des √©clairs permet maintenant de voir
o√π elle conduit: √† un ch√¢teau lugubre, obscur, dont la sinistre silhouette semble tapie au sommet
de la butte derri√®re de lourdes grilles de fer. La voiture noire et ses chevaux √©pouvant√©s ne vont
pas tarder √† l'atteindre.</p>
    
    <p>Nous sommes en Transylvanie, un pays recul√©, presque primitif, de l'Europe centrale, que la
plupart des voyageurs √©vitent et qui exerce g√©n√©ralement une √©trange influence sur les rares
personnes suffisamment t√©m√©raires pour s'y aventurer. Nous sommes en Transylvanie, une
r√©gion de for√™ts denses et de villages isol√©s dont l'organisation sociale n'a gu√®re connu de
changement depuis le temps des seigneurs f√©odaux. Nous sommes en Transylvanie o√π les gens
superstitieux se signent quand la nuit tombe et suspendent des chapelets d'ail au-dessus de leurs
fen√™tres soigneusement closes pour conjurer d'antiques mal√©fices dont les pays plus civilis√©s ont
depuis longtemps perdu le souvenir.</p>
    
    <p>La banquette de la voiture noire est occup√©e par un personnage solitaire, envelopp√© d'une lourde
cape qui dissimule son visage, ne laissant voir que ses yeux, au fond desquels br√ªle un feu sombre
anim√© par instants de lueurs rouge√¢tres. Tandis que la voiture cahote vers sa hideuse destination
au milieu des √©l√©ments d√©cha√Æn√©s, le voyageur solitaire demeure aussi immobile qu'une statue.
Qui peut bien √™tre cet homme, pour s'appr√™ter aussi calmement √† braver la nuit et √† affronter les
horreurs de ce repaire moyen√¢geux ? Quel est donc l'inconnu assis dans cette voiture noire qui se
pr√©cipite √† un train d'enfer vers les hautes grilles du Ch√¢teau de Dracula? Qui, en v√©rit√©... sinon
vous?</p>
    
    <button class="continue-button" onclick="showCharacterChoice()">Continuer</button>
  </div>

  <!-- √âcran de choix de personnage -->
  <div id="character-choice" class="passage hidden">
    <div class="title">Choisissez votre personnage</div>
    
    <p>Qui serez-vous dans cette aventure gothique ?</p>
    
    <div class="choices">
      <a href="#" onclick="showPassage('creation-jonathan')">Jonathan Harker</a>
      <a href="#" onclick="showPassage('creation-dracula')">Comte Dracula</a>
    </div>
  </div>

  <!-- Passage de cr√©ation pour Dracula -->
  <div id="creation-dracula" class="passage hidden">
    <div class="title">Cr√©ation du Comte Dracula</div>
    
    <div class="character-creation-layout">
      <!-- Colonne de stats -->
      <div class="stats-column">
        <div class="stats-header">Caract√©ristiques du Vampire</div>
        
        <table class="stats-table">
          <tr>
            <td>
              <span class="stat-label">RAPIDIT√â
                <div class="stat-tooltip">Vitesse surhumaine vous permettant de vous d√©placer comme une ombre.</div>
              </span>
            </td>
            <td><div id="dracula-rapidite" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('dracula-rapidite')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">COURAGE
                <div class="stat-tooltip">D√©termination et r√©sistance face aux chasseurs de vampires.</div>
              </span>
            </td>
            <td><div id="dracula-courage" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('dracula-courage')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">FORCE
                <div class="stat-tooltip">Puissance surnaturelle capable de plier le fer et de briser des os.</div>
              </span>
            </td>
            <td><div id="dracula-force" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('dracula-force')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">HABILET√â
                <div class="stat-tooltip">Pr√©cision et adresse dans la manipulation de vos pouvoirs vampiriques.</div>
              </span>
            </td>
            <td><div id="dracula-habilete" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('dracula-habilete')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">PSI
                <div class="stat-tooltip">Pouvoir mental pour contr√¥ler l'esprit des mortels et communiquer avec les cr√©atures de la nuit.</div>
              </span>
            </td>
            <td><div id="dracula-psi" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('dracula-psi')">Lancer</button></td>
          </tr>
        </table>
        
        <div class="money-section">
          <div class="money-title">Fortune initiale</div>
          <div class="money-value-container">
            <span id="dracula-money-value" class="money-value">-</span>
          </div>
          <button class="roll-button" onclick="rollMoney('dracula')">Lancer</button>
        </div>
      </div>
      
      <!-- Colonne de portrait -->
      <div class="portrait-column">
        <div class="portrait-frame">
          <img src="https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/a4b296d8cc1c3309159f33e810b303513ca2ce4d/img/chauve-souris.png" 
               alt="Comte Dracula" 
               class="dracula-image" />
        </div>
        
        <div style="margin-top: 20px; text-align: center; background-color: rgba(0,0,0,0.7); padding: 15px; border-radius: 5px; border: 1px solid #700;">
          <h3 style="margin-top: 0; color: #b00;">Comte Dracula</h3>
          <p style="margin-bottom: 0;">Seigneur des vampires, ma√Ætre des t√©n√®bres et souverain de la Transylvanie. Votre soif de sang est insatiable.</p>
        </div>
      </div>
    </div>
       <!-- Bouton pour continuer apr√®s avoir lanc√© la fortune -->
          <button id="dracula-continue" class="continue-button hidden" style="display: none; margin-top: 20px; background: linear-gradient(to bottom, #600, #300); color: #fff; padding: 10px 20px; border-radius: 5px; border: 1px solid #800; cursor: pointer;" onclick="goToPortail()">Continuer l'aventure</button>
        </div>
      </div>
   


  </div>

  <!-- Passage de cr√©ation pour Jonathan Harker -->
  <div id="creation-jonathan" class="passage hidden">
    <div class="title">Cr√©ation de Jonathan Harker</div>
    
    <div class="character-creation-layout">
      <!-- Colonne de stats -->
      <div class="stats-column">
        <div class="stats-header">Caract√©ristiques du Personnage</div>
        
        <table class="stats-table">
          <tr>
            <td>
              <span class="stat-label">RAPIDIT√â
                <div class="stat-tooltip">D√©termine votre agilit√© et votre vitesse de r√©action face au danger.</div>
              </span>
            </td>
            <td><div id="Jonathan-rapidite" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('Jonathan-rapidite')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">COURAGE
                <div class="stat-tooltip">Votre r√©sistance face √† la peur et capacit√© √† affronter l'horreur.</div>
              </span>
            </td>
            <td><div id="Jonathan-courage" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('Jonathan-courage')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">FORCE
                <div class="stat-tooltip">Votre puissance physique pour le combat et les √©preuves de force.</div>
              </span>
            </td>
            <td><div id="Jonathan-force" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('Jonathan-force')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">HABILET√â
                <div class="stat-tooltip">Votre adresse manuelle et capacit√© √† manipuler des objets avec pr√©cision.</div>
              </span>
            </td>
            <td><div id="Jonathan-habilete" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('Jonathan-habilete')">Lancer</button></td>
          </tr>
          <tr>
            <td>
              <span class="stat-label">PSI
                <div class="stat-tooltip">Votre force psychique et r√©sistance mentale face aux pouvoirs surnaturels.</div>
              </span>
            </td>
            <td><div id="Jonathan-psi" class="creation-die">-</div></td>
            <td><button class="roll-button" onclick="rollStat('Jonathan-psi')">Lancer</button></td>
          </tr>
        </table>
        
        <div class="money-section">
          <div class="money-title">Fortune initiale</div>
          <div class="money-value-container">
            <span id="Jonathan-money-value" class="money-value">-</span>
          </div>
          <button class="roll-button" onclick="rollMoney('Jonathan')">Lancer</button>
          
          <!-- Bouton pour continuer apr√®s avoir lanc√© la fortune -->
          <button id="jonathan-continue" class="continue-button hidden" style="display: none; margin-top: 20px; background: linear-gradient(to bottom, #600, #300); color: #fff; padding: 10px 20px; border-radius: 5px; border: 1px solid #800; cursor: pointer;" onclick="goToPortail()">Continuer l'aventure</button>
        </div>
      </div>
      
      <!-- Colonne de portrait -->
      <div class="portrait-column">
        <div class="portrait-frame">
          <img src="https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/f98913b21c18fe694f78179011c1655ccba1fc4c/img/jonathan_harker_portrait.png"
               alt="Jonathan Harker" 
               class="portrait-image" />
        </div>
        
        <div style="margin-top: 20px; text-align: center; background-color: rgba(0,0,0,0.7); padding: 15px; border-radius: 5px; border: 1px solid #700;">
          <h3 style="margin-top: 0; color: #b00;">Jonathan Harker</h3>
          <p style="margin-bottom: 0;">Jeune clerc de notaire envoy√© en Transylvanie pour finaliser la vente d'une propri√©t√© au myst√©rieux Comte Dracula.</p>
        </div>
      </div>
    </div>
  


  </div>
    
  <!-- Encadr√© de texte -->
  <div class="text-frame" id="text-frame">
    <div class="text-frame-header" id="text-frame-header">
      <div class="text-frame-title">Ch√¢teau de Dracula</div>
      <div class="text-frame-controls">
        <button id="minimize-btn" title="R√©duire">&#8722;</button>
        <button id="expand-btn" title="Agrandir">&#8593;</button>
      </div>
    </div>
    <div class="text-content" id="text-content"></div>
  </div>
  
  <!-- Conteneur pour l'image -->
  <div class="image-container" id="game-image-container"></div>
  
  <!-- √âl√©ments audio cach√©s -->
  <!-- √âl√©ment audio principal -->
<audio id="background-music" preload="auto" loop>
  <source src="https://fluffy-kashata-47db51.netlify.app/son/404_vampyr.mp3" type="audio/mpeg">
</audio>

<!-- √âl√©ments audio pour effets sonores -->
<audio id="thunder-sound" preload="auto">
  <source src="https://fluffy-kashata-47db51.netlify.app/son/thunder.mp3" type="audio/mpeg">
</audio>
<audio id="rain-sound" preload="auto" loop>
  <source src="https://fluffy-kashata-47db51.netlify.app/son/rain.mp3" type="audio/mpeg">
</audio>
<audio id="wolf-sound" preload="auto">
  <source src="https://fluffy-kashata-47db51.netlify.app/son/wolf.mp3" type="audio/mpeg">
</audio>
<audio id="wind-sound" preload="auto" loop>
  <source src="https://fluffy-kashata-47db51.netlify.app/son/ff_hffx_atmosphere_storm_windy.wav" type="audio/wav">
</audio>
<audio id="dice-sound" preload="auto">
  <source src="https://fluffy-kashata-47db51.netlify.app/son/dice.mp3" type="audio/mpeg">
</audio>
<audio id="wolf-sound" preload="auto">
  <source src="https://fluffy-kashata-47db51.netlify.app/son/ff_hffx_sfx_impact_jump_scare_blue.wav" type="audio/wav">
</audio> 

  <!-- Interface de combat -->
  <div id="combat-interface" class="combat-interface" style="display: none;">
    <div class="combat-header">
      <div class="combatant player">
        <h3>Vous</h3>
        <div class="health-bar">
          <div class="health-bar-bg">
            <div id="player-health-fill" class="health-bar-fill"></div>
          </div>
          <span id="player-combat-health">100</span>/<span id="player-combat-max-health">100</span>
        </div>
      </div>
      
      <div class="vs">VS</div>
      
      <div class="combatant enemy">
        <h3 id="enemy-combat-name">Ennemi</h3>
        <div class="health-bar">
          <div class="health-bar-bg">
            <div id="enemy-health-fill" class="health-bar-fill"></div>
          </div>
          <span id="enemy-combat-health">50</span>/<span id="enemy-combat-max-health">50</span>
        </div>
      </div>
    </div>
    
    <div class="combat-dice">
      <div id="combat-die-1" class="die">?</div>
      <div id="combat-die-2" class="die">?</div>
      <div id="combat-roll-result" class="dice-result">Lancez les d√©s</div>
    </div>
    
    <div class="combat-log-container">
      <div id="combat-log" class="combat-log">
        <div class="log-entry">Le combat commence !</div>
      </div>
    </div>
    
    <div class="combat-actions">
      <button id="attack-button" class="combat-button" onclick="attackEnemy()">Attaquer</button>
      <button id="use-psi-button" class="combat-button" onclick="usePsiPower()">Pouvoir PSI</button>
      <button id="flee-button" class="combat-button" onclick="attemptToFlee()">Fuir</button>
    </div>
  </div>

  <!-- Interface pour lancer des d√©s -->
  <div id="dice-roll-interface" class="dice-interface" style="display: none;">
    <div id="dice-roll-purpose" class="dice-purpose">Lancer pour d√©terminer le r√©sultat</div>
    <div class="dice-container">
      <div id="game-die-1" class="die">?</div>
      <div id="game-die-2" class="die">?</div>
    </div>
    <div id="dice-roll-result" class="dice-result">?</div>
    <button class="dice-button" onclick="rollGameDice()">Lancer les d√©s</button>
  </div>
</div>

  <!-- JavaScript -->
  <script>
    // Variables audio
    let audioEnabled = true;
    const audioElements = {
      thunder: document.getElementById('thunder-sound'),
      rain: document.getElementById('rain-sound'),
      wolf: document.getElementById('wolf-sound'),
      wind: document.getElementById('wind-sound'),
      dice: document.getElementById('dice-sound'),
      background: document.getElementById('background-music')
    };

    // Fonction pour lire un son
    function playSound(soundId, volume = 1.0) {
      if (!audioEnabled) return;
      
      const sound = audioElements[soundId];
      if (sound) {
        sound.volume = volume;
        sound.currentTime = 0;
        sound.play().catch(error => {
          console.warn('Lecture audio impossible :', error);
        });
      }
    }

    // Fonction pour d√©marrer un son en boucle
    function loopSound(soundId, volume = 0.4) {
      if (!audioEnabled) return;
      
      const sound = audioElements[soundId];
      if (sound) {
        sound.volume = volume;
        sound.loop = true;
        sound.play().catch(error => {
          console.warn('Lecture audio en boucle impossible :', error);
        });
      }
    }

    // Fonction pour arr√™ter un son
    function stopSound(soundId) {
      const sound = audioElements[soundId];
      if (sound) {
        sound.pause();
        sound.currentTime = 0;
      }
    }

    // Fonction pour activer/d√©sactiver tous les sons
    function toggleAudio() {
      audioEnabled = !audioEnabled;
      
      // Mettre √† jour le bouton
      const audioButton = document.getElementById('audioToggle');
      if (audioButton) {
        audioButton.innerHTML = audioEnabled ? '<span>üîä Son</span>' : '<span>üîá Son</span>';
      }
      
      // Activer/d√©sactiver tous les sons
      if (audioEnabled) {
        if (document.getElementById('passage-1').classList.contains('hidden') ||
            document.getElementById('passage-2').classList.contains('hidden')) {
          loopSound('background', 0.3);
        }
        if (!document.getElementById('passage-2').classList.contains('hidden')) {
          loopSound('rain', 0.3);
          loopSound('wind', 0.2);
        }
      } else {
        for (const key in audioElements) {
          stopSound(key);
        }
      }
      
      console.log('Audio ' + (audioEnabled ? 'activ√©' : 'd√©sactiv√©'));
    }

    // D√©marrer les sons d'ambiance au chargement
    document.addEventListener('DOMContentLoaded', function() {
      // Mettre un d√©lai pour √©viter les probl√®mes d'autoplay restrictifs
      setTimeout(() => {
        if (audioEnabled) {
          loopSound('background', 0.3);
        }
      }, 1000);
      
      // Connecter le bouton audio
      const audioButton = document.getElementById('audioToggle');
      if (audioButton) {
        audioButton.addEventListener('click', toggleAudio);
      }
    });

    // Initialisation de gameState
    window.gameState = {
      stats: { 
        rapidite: 0, 
        courage: 0, 
        force: 0, 
        habilete: 0, 
        psi: 0, 
        psiMax: 0, 
        health: 100, 
        maxHealth: 100, 
        money: 0 
      },
      inventory: [],
      enemyDefeated: {},
      combat: { 
        inCombat: false, 
        turn: null, 
        enemy: {} 
      },
      diceRollCallback: null,
      character: null,
      currentLocation: null,
      previousLocation: null,
      activeEffects: {}
    };

    // Fonctions
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebarContent');
      sidebar.classList.toggle('open');
    }
    
    // Fonction pour afficher un passage et cacher les autres
    function showPassage(passageId) {
      // Cacher tous les passages
      document.querySelectorAll('.passage').forEach(el => {
        el.classList.add('hidden');
      });
      
      // Afficher le passage demand√©
      const passageElement = document.getElementById(passageId);
      if (passageElement) {
        passageElement.classList.remove('hidden');
        
        // Gestion des sons en fonction du passage
        if (passageId === 'passage-1') {
          // √âcran titre
          stopSound('rain');
          stopSound('wind');
          loopSound('background', 0.3);
        } 
        else if (passageId === 'passage-2') {
          // Passage Transylvanie
          playSound('thunder', 0.7);
          setTimeout(() => playSound('wolf', 0.5), 2000);
          loopSound('rain', 0.3);
          loopSound('wind', 0.2);
        }
        else if (passageId === 'creation-jonathan' || passageId === 'creation-dracula') {
          // √âcrans de cr√©ation
          stopSound('rain');
          stopSound('wind');
          loopSound('background', 0.3);
        }
      }
    }
    
    // Fonction pour afficher le choix de personnage
    function showCharacterChoice() {
      showPassage('character-choice');
    }

	function rollStat(statId) {
	if (!window.gameState) window.gameState = {};
  if (!window.gameState.stats) window.gameState.stats = {};
		const statElement = document.getElementById(statId);
		if (!statElement) return;
  
		const statName = statId.split('-')[1];
		const value = Math.floor(Math.random() * 6) + 1;
  
		statElement.textContent = value;
  
		const sidebarElement = document.getElementById(`stat-${statName}`);
		if (sidebarElement) {
		sidebarElement.textContent = value;
		}
  
  // Mise √† jour de gameState
  if (!gameState.stats) gameState.stats = {};
  gameState.stats[statName] = value;
}

    // Fonction pour g√©rer le lancement de la fortune
    function rollMoney(character) {
        console.log(`Rolling money for ${character}`);
        // ... code existant ...
        
        // Afficher le bouton continuer
        const continueButton = document.getElementById(`${character}-continue`);
        console.log(`Continue button: ${continueButton ? 'found' : 'not found'}`);
        if (continueButton) {
            continueButton.style.display = 'block';
            console.log(`Setting button onclick for ${character}`);
        }
    }

    function checkAllStatsRolled(character) {
      const stats = ['rapidite', 'courage', 'force', 'habilete', 'psi'];
      let allRolled = true;
      
      // V√©rifier chaque statistique
      for (const stat of stats) {
        const statElement = document.getElementById(`${character}-${stat}`);
        if (statElement && statElement.textContent === '-') {
          allRolled = false;
          break;
        }
      }
      
      // Si toutes les stats sont lanc√©es, montrer le bouton continuer
      if (allRolled) {
        const continueButton = document.getElementById(`${character}-continue`);
        if (continueButton) {
          continueButton.classList.remove('hidden');
        }
      }
    }

    window.startGame = function(character) {
  console.log("D√©marrage du jeu avec:", character);
  
  // Masquer tous les √©crans pr√©c√©dents
  document.querySelectorAll('.passage, .sequence-screen').forEach(el => {
    el.classList.add('hidden');
    el.style.display = 'none';
  });
  
  // Afficher l'√©cran de jeu
  const gameScreen = document.getElementById('game-screen');
  if (gameScreen) {
    gameScreen.classList.remove('hidden');
    gameScreen.style.display = 'block';
  }
  
  // Mettre √† jour l'√©tat du jeu
  if (!window.gameState) window.gameState = {};
  window.gameState.character = character;
  
  // Mise √† jour du menu et des infos du joueur
  const playerNameEl = document.getElementById('player-name');
  const playerRoleEl = document.getElementById('player-role');
  
  if (playerNameEl && playerRoleEl) {
    if (character.toLowerCase() === 'jonathan') {
      playerNameEl.textContent = 'Nom: Jonathan Harker';
      playerRoleEl.textContent = 'R√¥le: Chasseur de vampires';
      document.body.classList.add('jonathan-theme');
      document.body.classList.remove('dracula-theme');
    } else if (character.toLowerCase() === 'dracula') {
      playerNameEl.textContent = 'Nom: Comte Dracula';
      playerRoleEl.textContent = 'R√¥le: Vampire';
      document.body.classList.add('dracula-theme');
      document.body.classList.remove('jonathan-theme');
    }
  }
  
  // Mise √† jour des statistiques
  if (typeof window.updateStatsDisplay === 'function') {
    window.updateStatsDisplay();
  }
  
  // Mise √† jour de l'inventaire
  if (typeof window.updateInventoryDisplay === 'function') {
    window.updateInventoryDisplay();
  }
  
  // Choisir le lieu initial et le texte narratif selon le personnage
  let startLocation, backgroundUrl, narrativeText;
  
  if (character.toLowerCase() === 'dracula') {
    startLocation = 'crypte-dracula';
    backgroundUrl = 'https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/7fcd2382286fa36045466ced1230791bfba67aff/img/crypte.jpg';
    narrativeText = "Vos yeux s'ouvrent. Il y a quelqu'un devant le portail ! Vous le savez avec autant de certitude que si vous vous teniez √† c√¥t√© de la voiture, une torche √† la main. Un instinct aiguis√© par des si√®cles de survie vous avertit d'un danger. Aucun mortel ordinaire n'oserait venir vous chercher ici, dans le ch√¢teau ancestral qui est depuis si longtemps le si√®ge de votre puissance. Un seul homme aurait l'audace d'y p√©n√©trer : le Dr Abraham van Helsing, m√©decin, avocat, m√©taphysicien et tueur de vampires...";
  } else {
    startLocation = 'portail';
    backgroundUrl = 'https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/4212d6845a41c07b62959c93f1031dfb97680410/img/all%C3%A9e_du_chateau4.jpg';
    narrativeText = "D'une main soigneusement manucur√©e, vous poussez les hautes grilles en fer forg√© du Ch√¢teau de Dracula. Sans opposer de r√©sistance, elles pivotent sur leurs gonds dans un √©trange silence, troubl√© seulement par le hurlement lointain d'un loup. Devant vous s'√©tend une all√©e orient√©e au nord. Elle vous conduira au manoir d√©moniaque et au monstre qui en est le seigneur.";
  }
  
  // Mettre √† jour l'UI avec les informations du lieu
  const locationTitle = document.getElementById('location-title');
  const locationDescription = document.getElementById('location-description');
  
  if (locationTitle && locationDescription) {
    // Utiliser les donn√©es du lieu depuis gamedata.js si disponible
    if (window.gameData && window.gameData.locations && window.gameData.locations[startLocation]) {
      const locationData = window.gameData.locations[startLocation];
      locationTitle.textContent = locationData.title || startLocation;
      locationDescription.textContent = narrativeText;
    } else {
      // Fallback si les donn√©es ne sont pas disponibles
      locationTitle.textContent = startLocation === 'crypte-dracula' ? "Crypte de Dracula" : "All√©e du Ch√¢teau";
      locationDescription.textContent = narrativeText;
    }
  }
  
  // Mettre √† jour les choix disponibles
  const choicesContainer = document.getElementById('choices-container');
  if (choicesContainer) {
    choicesContainer.innerHTML = '';
    
    if (character.toLowerCase() === 'dracula') {
      // Choix pour Dracula
      const choices = [
        { text: "Utiliser T√©l√©portation (co√ªte 1 PSI)", action: "usePsiPower" },
        { text: "Examiner le sarcophage", destination: "examiner-sarcophage" },
        { text: "Rechercher un passage secret", action: "searchSecret" }
      ];
      
      choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice';
        btn.textContent = choice.text;
        
        btn.onclick = () => {
          if (choice.destination && typeof window.navigateToLocation === 'function') {
            window.navigateToLocation(choice.destination);
          } else if (choice.action && typeof window[choice.action] === 'function') {
            window[choice.action]();
          }
        };
        
        choicesContainer.appendChild(btn);
      });
    } else {
      // Choix pour Jonathan
      const choices = [
        { text: "Continuer vers le nord", destination: "cour-honneur" },
        { text: "Explorer le sentier √† l'ouest", destination: "sentier-ouest" },
        { text: "Explorer le sentier √† l'est", destination: "sentier-est" },
        { text: "Rechercher un passage secret", action: "searchSecret" }
      ];
      
      choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice';
        btn.textContent = choice.text;
        
        btn.onclick = () => {
          if (choice.destination && typeof window.navigateToLocation === 'function') {
            window.navigateToLocation(choice.destination);
          } else if (choice.action && typeof window[choice.action] === 'function') {
            window[choice.action]();
          }
        };
        
        choicesContainer.appendChild(btn);
      });
    }
  }
  
  // Utiliser scene-manager pour afficher l'image de fond
  if (window.sceneManager && typeof window.sceneManager.showScene === 'function') {
    // Note: showScene g√®re normalement l'affichage de l'image de fond
    // Nous lui passons null comme ID pour √©viter qu'il n'essaie de g√©rer un passage HTML
    window.sceneManager.showScene(null, backgroundUrl);
  } else {
    // Fallback si scene-manager n'est pas disponible
    const bgElement = document.getElementById('scene-background');
    if (bgElement && backgroundUrl) {
      bgElement.innerHTML = '';
      const img = document.createElement('img');
      img.src = backgroundUrl;
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.objectFit = 'cover';
      img.style.opacity = '0.7';
      bgElement.appendChild(img);
    }
  }
};

// Version simplifi√©e de startAdventure qui appelle startGame
window.startAdventure = function(character) {
  return window.startGame(character);
};

    
    // Initialisation de l'image d'arri√®re-plan
    document.addEventListener('DOMContentLoaded', function() {
      const bgElement = document.getElementById('scene-background');
      if (bgElement) {
        // Cr√©er une image
        const img = document.createElement('img');
        img.src = 'https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/e3d10d43158d9937d9952e7a1d29a798ad5fc58e/img/Dracula3.jpg';
        img.style.width = '100%';
        img.style.height = '100%';
        img.style.objectFit = 'cover';
        img.style.opacity = '0.7';
        
        // Vider l'√©l√©ment et ajouter l'image
        bgElement.innerHTML = '';
        bgElement.appendChild(img);
        
        // Par d√©faut, montrer le premier passage
        showPassage('passage-1');
        
        console.log("Image d'arri√®re-plan ajout√©e au chargement de la page");
      }
    });
  </script>
  <!-- Script pour corriger la navigation et maintenir le son -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // 1. CORRECTION DE LA NAVIGATION PAR PAGES
    
    // Forcer la modification de la fonction showPassage pour remplacer le scroll par des changements de page complets
    window.showPassage = function(passageId) {
      console.log("Navigation vers:", passageId);
      
      // Cacher tous les passages
      document.querySelectorAll('.passage').forEach(el => {
        el.classList.add('hidden');
        el.style.display = 'none'; // Assurer que le passage est compl√®tement cach√©
      });
      
      // Afficher uniquement le passage demand√©
      const passageElement = document.getElementById(passageId);
      if (passageElement) {
        passageElement.classList.remove('hidden');
        passageElement.style.display = 'block'; // Assurer que le passage est compl√®tement visible
        
        // Remonter en haut de la page
        window.scrollTo(0, 0);
        
        // Gestion des sons en fonction du passage
        handleSoundsForPassage(passageId);
      }
    };
    
    // Fonction pour g√©rer les sons selon la page
    function handleSoundsForPassage(passageId) {
      console.log("Gestion du son pour:", passageId);
      
      // R√©f√©rences aux √©l√©ments audio
      const rainSound = document.getElementById('rain-sound');
      const thunderSound = document.getElementById('thunder-sound');
      const wolfSound = document.getElementById('wolf-sound');
      const windSound = document.getElementById('https://fluffy-kashata-47db51.netlify.app/son/ff_hffx_atmosphere_storm_windy.wav');
      const backgroundMusic = document.getElementById('https://fluffy-kashata-47db51.netlify.app/son/404_vampyr.mp3');
      
      // V√©rifier si les √©l√©ments audio existent
      if (!rainSound || !thunderSound || !wolfSound || !windSound || !backgroundMusic) {
        console.warn("Certains √©l√©ments audio sont manquants!");
        return;
      }
      
      if (passageId === 'passage-1') {
        // √âcran titre - Son de fond subtil
        if (backgroundMusic) {
          backgroundMusic.volume = 0.2;
          backgroundMusic.play().catch(e => console.warn("Impossible de jouer la musique:", e));
        }
      } 
      else if (passageId === 'passage-2') {
        // Passage Transylvanie - Ambiance compl√®te
        if (rainSound) {
          rainSound.volume = 0.4;
          rainSound.loop = true;
          rainSound.play().catch(e => console.warn("Impossible de jouer la pluie:", e));
        }
        
        if (windSound) {
          windSound.volume = 0.3;
          windSound.loop = true;
          windSound.play().catch(e => console.warn("Impossible de jouer le vent:", e));
        }
        
        // Jouer le tonnerre apr√®s un court d√©lai
        setTimeout(() => {
          if (thunderSound) {
            thunderSound.volume = 0.7;
            thunderSound.play().catch(e => console.warn("Impossible de jouer le tonnerre:", e));
          }
        }, 1500);
        
        // Jouer le loup apr√®s un d√©lai plus long
        setTimeout(() => {
          if (wolfSound) {
            wolfSound.volume = 0.5;
            wolfSound.play().catch(e => console.warn("Impossible de jouer le loup:", e));
          }
        }, 3000);
      }
      else if (passageId === 'character-choice' || passageId.includes('creation-')) {
        // √âcrans de choix et cr√©ation - Maintenir la pluie en fond mais √† volume r√©duit
        if (rainSound) {
          rainSound.volume = 0.2;
          // Ne pas arr√™ter la pluie, juste r√©duire son volume
        }
        
        if (windSound) {
          windSound.volume = 0.1;
          // Ne pas arr√™ter le vent, juste r√©duire son volume
        }
      }
    }
    
    // 2. CORRECTION DES BOUTONS POUR UTILISER LA NOUVELLE NAVIGATION
    
    // Reconfigurer tous les boutons de navigation
    function fixAllNavigationButtons() {
      // Bouton "Commencer l'aventure" sur l'√©cran titre
      const startButton = document.querySelector('#passage-1 .start-button');
      if (startButton) {
        startButton.onclick = function() {
          showPassage('passage-2');
        };
      }
      
      // Bouton "Continuer" sur l'√©cran Transylvanie
      const continueButton = document.querySelector('#passage-2 .continue-button');
      if (continueButton) {
        continueButton.onclick = function() {
          showPassage('character-choice');
        };
      }
      
      // Boutons de choix de personnage
      const choiceButtons = document.querySelectorAll('#character-choice .choices a');
      choiceButtons.forEach(button => {
        button.onclick = function(e) {
          e.preventDefault();
          const target = this.getAttribute('onclick') || '';
          if (target.includes('creation-jonathan')) {
            showPassage('creation-jonathan');
          } else if (target.includes('creation-dracula')) {
            showPassage('creation-dracula');
          }
        };
      });
    }
    
    // Appliquer les corrections apr√®s un court d√©lai pour s'assurer que tout est charg√©
    setTimeout(fixAllNavigationButtons, 500);
    
    // Afficher la premi√®re page au chargement
    showPassage('passage-1');
    
    // 3. CORRECTION DU BOUTON AUDIO
    
    // S'assurer que le bouton audio est toujours visible et fonctionne
    const audioToggle = document.getElementById('audioToggle');
    if (audioToggle) {
      audioToggle.style.position = 'fixed';
      audioToggle.style.top = '20px';
      audioToggle.style.right = '20px';
      audioToggle.style.zIndex = '9999';
      
      // R√©initialiser la fonction du bouton audio
      audioToggle.onclick = function() {
        toggleAudio();
      };
    }
    
    // Variable globale pour l'√©tat du son
    window.audioEnabled = true;
    
    // Fonction pour activer/d√©sactiver tous les sons
    window.toggleAudio = function() {
      window.audioEnabled = !window.audioEnabled;
      
      // Mettre √† jour le bouton
      if (audioToggle) {
        audioToggle.innerHTML = window.audioEnabled ? '<span>üîä Son</span>' : '<span>üîá Son</span>';
      }
      
      // Liste des sons √† contr√¥ler
      const sounds = ['rain-sound', 'thunder-sound', 'wolf-sound', 'wind-sound', 'background-music'];
      
      // Activer/d√©sactiver tous les sons
      sounds.forEach(soundId => {
        const sound = document.getElementById(soundId);
        if (sound) {
          if (window.audioEnabled) {
            // Si c'est un son en boucle, le red√©marrer
            if (sound.loop) {
              sound.play().catch(e => console.warn(`Impossible de jouer ${soundId}:`, e));
            }
          } else {
            sound.pause();
          }
        }
      });
      
      console.log('Audio ' + (window.audioEnabled ? 'activ√©' : 'd√©sactiv√©'));
    };
  });
</script>


<!-- √âl√©ments audio avec preload pour √™tre pr√™ts √† jouer imm√©diatement -->
<audio id="thunder-sound" preload="auto">
  <source src="https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/main/audio/thunder.mp3" type="audio/mpeg">
</audio>
<audio id="rain-sound" preload="auto" loop>
  <source src="https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/main/audio/rain.mp3" type="audio/mpeg">
</audio>
<audio id="wolf-sound" preload="auto">
  <source src="https://fluffy-kashata-47db51.netlify.app/son/ff_hffx_sfx_impact_jump_scare_blue.wav" type="audio/wav">
</audio>
<audio id="wind-sound" preload="auto" loop>
  <source src="https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/main/audio/wind.mp3" type="audio/mpeg">
</audio>
<audio id="dice-sound" preload="auto">
  <source src="https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/main/audio/dice.mp3" type="audio/mpeg">
</audio>
<audio id="background-music" preload="auto" loop>
  <source src="https://fluffy-kashata-47db51.netlify.app/son/404_vampyr.mp3" type="audio/mp3">
</audio>
<audio id="dracula-sound" preload="auto">
  <source src="https://fluffy-kashata-47db51.netlify.app/son/ff_hffx_sfx_impact_jump_scare_blue.wav" type="audio/wav">
</audio>
 

<!-- Bouton audio bien visible -->
<button id="audioToggle" style="position: fixed; top: 20px; right: 20px; z-index: 9999; background-color: #500; color: #fff; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 1em; border: 1px solid #800; box-shadow: 0 0 10px rgba(0,0,0,0.5);">
  <span>üîä Son</span>
</button>



<!-- Syst√®me audio unifi√© -->


<div id="scene-background" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -5;"></div>


<!-- Donn√©es du jeu -->

<script src="main.js"></script>


<!-- Correctif sp√©cifique pour rollMoney et le menu -->
<script src="fix-roll-money.js"></script>


<!-- Correctif sp√©cifique pour les boutons et les d√©s -->
<script src="dice-button-fix.js"></script>
<!-- Bouton de retour -->
<script src="return-button.js"></script>



<!-- √âl√©ment audio principal -->
<audio id="background-music" preload="auto" loop>
  <source src="https://fluffy-kashata-47db51.netlify.app/son/404_vampyr.mp3" type="audio/mp3">
</audio>

<!-- √âcran d'activation audio direct -->
<div id="direct-audio-activation" style="position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.9); display:flex; justify-content:center; align-items:center; z-index:10000;">
  <button id="direct-audio-button" style="padding:20px 40px; font-size:1.5em; background:linear-gradient(to bottom, #900, #500); color:white; border:none; border-radius:10px; cursor:pointer;">
    Cliquez pour activer le son et commencer l'aventure
  </button>
</div>

<!-- Script d'activation audio int√©gr√© directement -->
<script>
  // Obtenir le bouton
  const directButton = document.getElementById('direct-audio-button');
  
  // Ajouter un gestionnaire d'√©v√©nement au clic
  if (directButton) {
    directButton.addEventListener('click', function() {
      console.log("üëâ Bouton d'activation directe cliqu√©");
      
      // Masquer l'√©cran d'activation
      document.getElementById('direct-audio-activation').style.display = 'none';
      
      // Activer l'audio global
      window.audioEnabled = true;
      
      // Jouer le son de fond directement
      const backgroundAudio = document.getElementById('background-music');
      if (backgroundAudio) {
        backgroundAudio.volume = 0.3;
        backgroundAudio.loop = true;
        backgroundAudio.play().catch(function(error) {
          console.error("‚ùå Impossible de jouer le son de fond:", error);
          // Afficher quand m√™me le premier √©cran m√™me si le son ne marche pas
          showFirstScreen();
        });
        
        // Afficher le premier √©cran
        showFirstScreen();
      } else {
        console.error("‚ùå √âl√©ment audio 'background-music' non trouv√©");
        // Afficher quand m√™me le premier √©cran
        showFirstScreen();
      }
    });
  } else {
    console.error("‚ùå Bouton d'activation directe non trouv√©");
  }
  
  // Fonction pour afficher le premier √©cran
  function showFirstScreen() {
    const firstScreen = document.getElementById('passage-1');
    if (firstScreen) {
      firstScreen.classList.remove('hidden');
      firstScreen.style.display = 'block';
    } else {
      console.error("‚ùå √âl√©ment 'passage-1' non trouv√©");
    }
  }
  
  // Fonction pour la navigation entre les passages
  window.showPassage = function(passageId) {
    console.log("Navigation vers passage:", passageId);
    
    // Cacher tous les passages
    document.querySelectorAll('.passage').forEach(function(passage) {
      passage.classList.add('hidden');
      passage.style.display = 'none';
    });
    
    // Afficher le passage demand√©
    const targetPassage = document.getElementById(passageId);
    if (targetPassage) {
      targetPassage.classList.remove('hidden');
      targetPassage.style.display = 'block';
      window.scrollTo(0, 0);
    } else {
      console.error("‚ùå Passage non trouv√©:", passageId);
    }
  };
  
  // Correction pour le bouton commencer l'aventure
  document.addEventListener('DOMContentLoaded', function() {
    const startButton = document.querySelector('.start-button');
    if (startButton) {
      startButton.addEventListener('click', function() {
        console.log("Bouton commencer l'aventure cliqu√©");
        window.showPassage('passage-2');
      });
    }
  });
</script>
  <!-- √âcran principal de jeu -->
<div id="game-screen" class="hidden">
  <h1 id="location-title"></h1>
  <p id="location-description"></p>
  <div id="choices-container"></div>
</div>

<script>
  // Script de d√©bogage pour images
  document.addEventListener('DOMContentLoaded', function() {
    console.log("V√©rification des images...");
    
    // V√©rifier scene-background
    const bgElement = document.getElementById('scene-background');
    console.log("scene-background existe:", !!bgElement);
    
    // Essayer de charger une image de test
    const testImg = new Image();
    testImg.onload = function() { console.log("‚úÖ Image de test charg√©e avec succ√®s"); };
    testImg.onerror = function() { console.log("‚ùå Erreur de chargement de l'image de test"); };
    testImg.src = 'https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/e3d10d43158d9937d9952e7a1d29a798ad5fc58e/img/Dracula3.jpg';
    
    // V√©rifier si l'image d'arri√®re-plan est d√©j√† d√©finie
    if (bgElement) {
      console.log("Contenu actuel de scene-background:", bgElement.innerHTML);
      
      // Forcer l'affichage d'une image de test
      bgElement.innerHTML = '';
      const forcedImg = document.createElement('img');
      forcedImg.src = 'https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/e3d10d43158d9937d9952e7a1d29a798ad5fc58e/img/Dracula3.jpg';
      forcedImg.style.width = '100%';
      forcedImg.style.height = '100%';
      forcedImg.style.objectFit = 'cover';
      forcedImg.style.opacity = '0.7';
      bgElement.appendChild(forcedImg);
      console.log("Image de fond forc√©e");
    }
  });
  
  function goToPortail() {
  let character;

  // D√©tection automatique selon le bouton visible
  if (!document.getElementById('creation-dracula').classList.contains('hidden')) {
    character = 'dracula';
  } else if (!document.getElementById('creation-jonathan').classList.contains('hidden')) {
    character = 'jonathan';
  }

  if (character) {
    localStorage.setItem('selectedCharacter', character);
    window.location.href = 'improved-ui-v2.html';
  } else {
    alert("Aucun personnage s√©lectionn√©.");
  }
}


function goToCrypteDracula() {
    console.log("Navigation vers la crypte de Dracula");
    // Effacer le contenu actuel
    document.querySelectorAll('.passage').forEach(passage => {
        passage.classList.add('hidden');
    });
    
    // Afficher le passage de la crypte
    const cryptePassage = document.getElementById('crypte-de-dracula-passage');
    if (cryptePassage) {
        cryptePassage.classList.remove('hidden');
    } else {
        console.error("Passage de la crypte non trouv√©");
    }
}
</script>
<!-- Avant la fermeture de la balise body -->

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Initialiser le gestionnaire d'√©tat du jeu (si ce n'est pas d√©j√† fait)
    if (window.GameStateManager && typeof window.GameStateManager.initialize === 'function') {
      window.GameStateManager.initialize();
    }
    
    // Initialiser le contr√¥leur UI
    if (window.UIController && typeof window.UIController.initialize === 'function') {
      window.UIController.initialize();
    }
    
    // S'assurer que le scene-manager est √©galement initialis√©
    if (window.sceneManager && window.sceneManager.showScene) {
      // Le scene-manager est d√©j√† pr√™t
      console.log("Scene Manager d√©j√† initialis√©");
    }
    
    console.log("Int√©gration UI Controller termin√©e");
  });
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  // Suppression d'un √©ventuel start-button
  const startButton = document.getElementById("start-button");
  if (startButton) {
    startButton.remove();
  }

  // Bouton Jonathan
  const jonContinueBtn = document.getElementById("jonathan-continue");
  if (jonContinueBtn) {
    jonContinueBtn.addEventListener("click", function () {
      console.log("Jonathan Continue cliqu√©, on va sur improved-ui-v2.html");
      window.location.href = "improved-ui-v2.html
";
    });
  }

  // Bouton Dracula
  const dracContinueBtn = document.getElementById("dracula-continue");
  if (!dracContinueBtn) {
    console.error("Le bouton 'dracula-continue' est introuvable !");
  } else {
    console.log("Bouton 'dracula-continue' d√©tect√© :", dracContinueBtn);
    dracContinueBtn.addEventListener("click", function () {
      console.log("Dracula Continue cliqu√©, on va sur improved-ui-v2.html");
      window.location.href = "improved-ui-v2.html";
    });
  }
});

</script>
<script>
// Correctif pour la fonction rollMoney
// Ce script r√©sout le probl√®me d'initialisation de la fortune dans l'√©cran de cr√©ation de personnage

// On attend que le DOM soit compl√®tement charg√©
document.addEventListener('DOMContentLoaded', function() {
    console.log("üé≤ Initialisation du correctif pour rollMoney");
    
    // Fonction universelle pour lancer la fortune initiale
    window.rollMoney = function(character) {
        console.log(`üé≤ Lancement de la fortune pour ${character}`);
        
        // Trouver l'√©l√©ment d'affichage de la fortune
        const moneyValueElement = document.getElementById(`${character}-money-value`);
        if (!moneyValueElement) {
            console.error(`‚ùå √âl√©ment ${character}-money-value non trouv√©`);
            return;
        }
        
        // Lancer les d√©s (2d6 √ó 4)
        const die1 = Math.floor(Math.random() * 6) + 1;
        const die2 = Math.floor(Math.random() * 6) + 1;
        const total = (die1 + die2) * 4;
        
        // Jouer le son des d√©s
        if (window.playSound) {
            window.playSound('dice-sound', 0.5);
        }
        
        // Mettre √† jour l'affichage
        moneyValueElement.textContent = total;
        console.log(`üí∞ Fortune g√©n√©r√©e pour ${character}: ${total}`);
        
        // Mettre √† jour l'√©tat du jeu
        if (window.gameState) {
            window.gameState.stats = window.gameState.stats || {};
            window.gameState.stats.money = total;
        }
        
        // Afficher le bouton "Continuer"
        const continueButton = document.getElementById(`${character}-continue`);
        if (continueButton) {
            continueButton.style.display = 'block';
            continueButton.classList.remove('hidden');
            console.log(`‚úÖ Bouton Continuer affich√© pour ${character}`);
        } else {
            console.error(`‚ùå Bouton ${character}-continue non trouv√©`);
        }
        
        // V√©rifier toutes les statistiques
        checkAllStatsRolled(character);
    };
    
    // Fonction pour v√©rifier si toutes les stats ont √©t√© lanc√©es
    function checkAllStatsRolled(character) {
        const stats = ['rapidite', 'courage', 'force', 'habilete', 'psi'];
        const allRolled = stats.every(stat => {
            const statEl = document.getElementById(`${character}-${stat}`);
            return statEl && statEl.textContent !== '-';
        });
        
        // V√©rifier √©galement si l'argent a √©t√© lanc√©
        const moneyEl = document.getElementById(`${character}-money-value`);
        const moneyRolled = moneyEl && moneyEl.textContent !== '-';
        
        if (allRolled && moneyRolled) {
            console.log(`‚úÖ Toutes les stats sont lanc√©es pour ${character}`);
            const continueButton = document.getElementById(`${character}-continue`);
            if (continueButton) {
                continueButton.style.display = 'block';
                continueButton.classList.remove('hidden');
            }
        }
    }
    
    // Fonction pour attacher les boutons
    function attachMoneyButtons() {
        console.log("üîç Recherche des boutons de lancement de fortune");
        
        // D√©finir les s√©lecteurs possibles
        const buttonSelectors = [
            // Pour Jonathan
            'button.roll-button[onclick*="rollMoney(\'Jonathan\')"]',
            'button.roll-button[onclick*="rollMoneyJonathan"]',
            '#creation-jonathan .money-section button.roll-button',
            // Pour Dracula
            'button.roll-button[onclick*="rollMoney(\'dracula\')"]',
            'button.roll-button[onclick*="rollMoneyDracula"]',
            '#creation-dracula .money-section button.roll-button'
        ];
        
        // Parcourir tous les s√©lecteurs possibles
        buttonSelectors.forEach(selector => {
            const buttons = document.querySelectorAll(selector);
            console.log(`üîç S√©lecteur "${selector}" a trouv√© ${buttons.length} boutons`);
            
            buttons.forEach(button => {
                const parentNode = button.parentNode;
                let character = null;
                
                // D√©terminer le personnage associ√©
                if (parentNode.closest('#creation-jonathan') || 
                    selector.includes('Jonathan') || 
                    button.getAttribute('onclick')?.includes('Jonathan')) {
                    character = 'Jonathan';
                } else if (parentNode.closest('#creation-dracula') || 
                          selector.includes('dracula') || 
                          button.getAttribute('onclick')?.includes('dracula')) {
                    character = 'dracula';
                }
                
                if (character) {
                    console.log(`‚úÖ Bouton de lancement de fortune trouv√© pour ${character}`);
                    
                    // Remplacer le gestionnaire d'√©v√©nements
                    button.onclick = function(event) {
                        if (event) event.preventDefault();
                        window.rollMoney(character);
                    };
                }
            });
        });
        
        // Recherche directe dans le DOM pour les boutons de fortune
        const moneyButtons = document.querySelectorAll('.money-section button, button.roll-button');
        moneyButtons.forEach(button => {
            // V√©rifier si c'est un bouton de fortune en analysant son texte ou celui de son parent
            const buttonText = button.textContent.toLowerCase();
            const parentText = button.parentElement ? button.parentElement.textContent.toLowerCase() : '';
            
            if (buttonText.includes('lancer') || parentText.includes('fortune')) {
                // D√©terminer le personnage
                let character = null;
                if (button.closest('#creation-jonathan')) {
                    character = 'Jonathan';
                } else if (button.closest('#creation-dracula')) {
                    character = 'dracula';
                }
                
                if (character) {
                    console.log(`‚úÖ Bouton de fortune identifi√© par texte pour ${character}`);
                    button.onclick = function(event) {
                        if (event) event.preventDefault();
                        window.rollMoney(character);
                    };
                }
            }
        });
    }
    
    // D√©finir explicitement les fonctions sp√©cifiques pour Jonathan et Dracula
    window.rollMoneyJonathan = function() {
        window.rollMoney('Jonathan');
    };
    
    window.rollMoneyDracula = function() {
        window.rollMoney('dracula');
    };
    
    // Initialiser les boutons apr√®s un court d√©lai pour s'assurer que tout est charg√©
    setTimeout(attachMoneyButtons, 500);
    
    // R√©essayer p√©riodiquement au cas o√π les boutons seraient ajout√©s dynamiquement
    setInterval(attachMoneyButtons, 3000);
    
    console.log("üéÆ Correctif pour rollMoney install√© avec succ√®s");
});

<script>

  // D√©tection et installation des am√©liorations
  (function() {
    // V√©rifier si les am√©liorations sont d√©j√† install√©es
    if (window.chateauDraculaEnhancementsInstalled) return;
    
    // Cr√©er et ajouter le script d'installation principal
    const script = document.createElement('script');
    script.src = "https://raw.githubusercontent.com/votre-user/chateau-dracula/main/main-fix.js";
    
    // En cas d'√©chec du chargement depuis GitHub, utiliser la version de secours
    script.onerror = function() {
      const backupScript = document.createElement('script');
      backupScript.textContent = `
        // Copier ici le contenu du fichier main-fix.js
      `;
      document.body.appendChild(backupScript);
    };
    
    document.body.appendChild(script);
    window.chateauDraculaEnhancementsInstalled = true;
  })();
</script>


<!-- Script autonome pour le bouton "Revenir" -->
<script>
// Script pour ajouter le bouton "Revenir" ind√©pendamment des autres scripts
(function() {
  // Ex√©cuter apr√®s le chargement complet du DOM
  document.addEventListener('DOMContentLoaded', function() {
    // Cr√©er le style si n√©cessaire
    if (!document.getElementById('back-button')) {
      const style = document.createElement('style');
      style.id = back-button';
      style.textContent = `
        #bouton-revenir {
          position: fixed;
          bottom: 20px;
          left: 20px;
          padding: 10px 15px;
          background: linear-gradient(to bottom, #600, #300);
          color: #fff;
          text-align: center;
          text-decoration: none;
          border-radius: 5px;
          font-size: 1.1em;
          cursor: pointer;
          border: 1px solid #800;
          z-index: 9999;
          font-family: 'Georgia', serif;
          box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
          transition: all 0.3s ease;
          display: block;
        }
        
        #bouton-revenir:hover {
          background: linear-gradient(to bottom, #800, #500);
          transform: translateY(-3px) scale(1.05);
          box-shadow: 0 8px 20px rgba(0,0,0,0.5), 0 0 20px rgba(128,0,0,0.5);
        }
        
        #bouton-revenir:active {
          transform: translateY(1px);
          box-shadow: 0 2px 10px rgba(0,0,0,0.4);
        }
        
        #bouton-revenir::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(
            to right,
            transparent 0%,
            rgba(255,255,255,0.2) 50%,
            transparent 100%
          );
          transition: left 0.7s ease;
        }
        
        #bouton-revenir:hover::before {
          left: 100%;
        }
      `;
      document.head.appendChild(style);
    }
    
    // Cr√©er le bouton s'il n'existe pas d√©j√†
    if (!document.getElementById('back-button')) {
      const button = document.createElement('button');
      button.id = ''backbutton';
      button.textContent = 'Revenir';
      
      // Ajouter la logique du bouton
      button.addEventListener('click', function() {
        const currentPage = getCurrentPage();
        
        if (currentPage === 'passage-2') {
          navigateTo('passage-1');
        } else if (currentPage === 'character-choice') {
          navigateTo('passage-2');
        } else if (currentPage === 'creation-jonathan' || currentPage === 'creation-dracula') {
          navigateTo('character-choice');
        } else {
          window.history.back();
        }
      });
      
      // Ajouter le bouton au document
      document.body.appendChild(button);
      
      // Mettre √† jour sa visibilit√© initiale
      setTimeout(updateButtonVisibility, 500);
    }
  });
  
  // Fonction pour d√©terminer la page actuelle
  function getCurrentPage() {
    const visiblePassages = document.querySelectorAll('.passage:not(.hidden)');
    return visiblePassages.length > 0 ? visiblePassages[0].id : null;
  }
  
  // Fonction pour naviguer vers une page
  function navigateTo(pageId) {
    // Si la fonction showPassage existe d√©j√†, l'utiliser
    if (typeof window.showPassage === 'function') {
      window.showPassage(pageId);
    } else {
      // Sinon, impl√©menter notre propre navigation
      // Cacher toutes les pages
      document.querySelectorAll('.passage').forEach(p => {
        p.classList.add('hidden');
        p.style.display = 'none';
      });
      
      // Afficher la page demand√©e
      const targetPage = document.getElementById(pageId);
      if (targetPage) {
        targetPage.classList.remove('hidden');
        targetPage.style.display = 'block';
        window.scrollTo(0, 0);
      }
    }
    
    // Mettre √† jour la visibilit√© du bouton
    setTimeout(updateButtonVisibility, 100);
  }
  
  // Mise √† jour de la visibilit√© du bouton
  function updateButtonVisibility() {
    const button = document.getElementById('bouton-revenir');
    const currentPage = getCurrentPage();
    
    if (button && currentPage) {
      // Cacher sur la page d'accueil
      if (currentPage === 'passage-1') {
        button.style.display = 'none';
      } else {
        button.style.display = 'block';
      }
    }
  }
  
  // Observer les changements de visibilit√© des passages
  const observer = new MutationObserver(function(mutations) {
    updateButtonVisibility();
  });
  
  // Configurer l'observation apr√®s le chargement du DOM
  document.addEventListener('DOMContentLoaded', function() {
    // Observer le document pour d√©tecter les changements de classes
    observer.observe(document.body, { 
      subtree: true, 
      attributes: true,
      attributeFilter: ['class', 'style'] 
    });
    
    // Patcher la fonction showPassage si elle existe
    if (typeof window.showPassage === 'function') {
      const originalShowPassage = window.showPassage;
      window.showPassage = function(passageId) {
        originalShowPassage(passageId);
        setTimeout(updateButtonVisibility, 100);
      };
    }
  });
})();

// Solution simplifi√©e pour rollStat et rollMoney
window.rollStat = function(statId) {
  var value = Math.floor(Math.random() * 6) + 1;
  document.getElementById(statId).textContent = value;
  
  // Mettre √† jour la barre lat√©rale
  var statName = statId.split('-')[1];
  document.getElementById('stat-' + statName).textContent = value;
};

window.rollMoney = function(character) {
  var total = Math.floor(Math.random() * 12) * 4 + 8;
  document.getElementById(character + '-money-value').textContent = total;
  document.getElementById(character + '-continue').classList.remove('hidden');
};
<!-- √Ä la fin de votre document HTML, apr√®s tous les autres scripts -->

// Correction pour le lancement de l'aventure
(function() {
  console.log("Chargement de la correction pour le lancement de l'aventure...");
  
  // V√©rifier si le document est d√©j√† charg√©
  if (document.readyState === "complete" || document.readyState === "interactive") {
    fixStartButtons();
  } else {
    // Sinon attendre le chargement
    document.addEventListener("DOMContentLoaded", fixStartButtons);
  }
  
  // Fonction pour corriger les boutons de d√©marrage
  function fixStartButtons() {
    console.log("Application des correctifs pour les boutons de d√©marrage...");
    
    // Trouver les boutons
    const jonathanButton = document.getElementById('Jonathan-continue');
    const draculaButton = document.getElementById('dracula-continue');
    
    // Corriger le bouton Jonathan
    if (jonathanButton) {
      console.log("Bouton Jonathan trouv√©, reconfiguration...");
      jonathanButton.onclick = function(event) {
        event.preventDefault();
        console.log("Bouton Jonathan cliqu√©");
        launchGame('jonathan');
        return false;
      };
    } else {
      console.warn("Bouton Jonathan non trouv√©");
    }
    
    // Corriger le bouton Dracula
    if (draculaButton) {
      console.log("Bouton Dracula trouv√©, reconfiguration...");
      draculaButton.onclick = function(event) {
        event.preventDefault();
        console.log("Bouton Dracula cliqu√©");
        launchGame('dracula');
        return false;
      };
    } else {
      console.warn("Bouton Dracula non trouv√©");
    }
    
    // Inspecter tous les boutons avec la classe choice-button
    const allButtons = document.querySelectorAll('.choice-button');
    console.log(`${allButtons.length} boutons de classe choice-button trouv√©s`);
    
    allButtons.forEach((button, index) => {
      console.log(`Bouton ${index+1}:`, button.id, button.textContent.trim());
      if (button.textContent.includes("Commencer l'aventure")) {
        console.log(`Reconfiguration du bouton ${index+1}...`);
        button.onclick = function(event) {
          event.preventDefault();
          const character = button.id.includes('Jonathan') ? 'jonathan' : 'dracula';
          console.log(`Bouton ${index+1} cliqu√© pour ${character}`);
          launchGame(character);
          return false;
        };
      }
    });
  }
  
  // Fonction pour lancer le jeu directement
  function launchGame(character) {
    console.log(`Lancement direct du jeu avec ${character}`);
    
    // 1. Cacher tous les passages
    document.querySelectorAll('.passage').forEach(el => {
      el.classList.add('hidden');
      el.style.display = 'none';
    });
    
    // 2. Mettre √† jour l'√©tat du jeu
    if (window.gameState) {
      window.gameState.character = character;
    } else {
      window.gameState = { character: character };
    }
    
    // 3. Appliquer le th√®me appropri√©
    if (character === 'jonathan') {
      document.body.classList.add('jonathan-theme');
      document.body.classList.remove('dracula-theme');
    } else {
      document.body.classList.add('dracula-theme');
      document.body.classList.remove('jonathan-theme');
    }
    
    // 4. Afficher l'√©cran de jeu
    const gameScreen = document.getElementById('game-screen');
    if (gameScreen) {
      gameScreen.classList.remove('hidden');
      gameScreen.style.display = 'block';
    } else {
      console.error("√âcran de jeu introuvable!");
      alert("Erreur: √âcran de jeu introuvable!");
      return;
    }
    
    // 5. Essayer toutes les m√©thodes possibles pour naviguer vers la premi√®re location
    try {
      const location = character === 'jonathan' ? 'portail' : 'crypte-dracula';
      
      // Essai 1: La fonction navigateToLocation
      if (typeof window.navigateToLocation === 'function') {
        console.log(`Navigation vers ${location} avec navigateToLocation`);
        window.navigateToLocation(location);
        return;
      }
      
      // Essai 2: Trouver l'objet de localisation directement
      if (window.gameData && window.gameData.locations && window.gameData.locations[location]) {
        console.log(`Chargement direct de la location ${location}`);
        const locationData = window.gameData.locations[location];
        
        // Mise √† jour de l'interface
        const titleEl = document.getElementById('location-title');
        const descEl = document.getElementById('location-description');
        const choicesEl = document.getElementById('choices-container');
        
        if (titleEl) titleEl.textContent = locationData.title || `Location: ${location}`;
        if (descEl) descEl.textContent = locationData.description || "Description non disponible.";
        
        // Cr√©er les choix
        if (choicesEl && locationData.choices) {
          choicesEl.innerHTML = '';
          
          locationData.choices.forEach(choice => {
            const button = document.createElement('div');
            button.className = 'choice';
            button.textContent = choice.text;
            
            if (choice.destination) {
              button.onclick = function() {
                if (typeof window.navigateToLocation === 'function') {
                  window.navigateToLocation(choice.destination);
                } else {
                  console.error(`Impossible de naviguer vers ${choice.destination}`);
                  alert(`Erreur: Navigation impossible vers ${choice.destination}`);
                }
              };
            }
            
            choicesEl.appendChild(button);
          });
        }
        
        return;
      }
      
      // Si aucune solution ne fonctionne, cr√©er une interface minimale
      console.warn("Aucune m√©thode de navigation n'a fonctionn√©, cr√©ation d'une interface minimale");
      
      const gameContent = document.createElement('div');
      gameContent.className = 'game-content';
      gameContent.innerHTML = `
        <h1 id="location-title">D√©but de l'aventure: ${character === 'jonathan' ? 'Jonathan Harker' : 'Comte Dracula'}</h1>
        <p id="location-description">Votre aventure commence. L'atmosph√®re est lourde et inqui√©tante...</p>
        <div id="choices-container" class="choices">
          <div class="choice">Explorer les environs</div>
          <div class="choice">Attendre</div>
        </div>
      `;
 <script>
      gameScreen.innerHTML = '';
      gameScreen.appendChild(gameContent);
      
    } catch (error) {
      console.error("Erreur lors du d√©marrage du jeu:", error);
      alert("Une erreur s'est produite lors du d√©marrage du jeu. Consultez la console pour plus de d√©tails.");
    }
  }
  
  // D√©finir la fonction globalement pour pouvoir l'appeler depuis le HTML
  window.launchGame = launchGame;
  
  // R√©essayer p√©riodiquement au cas o√π les boutons sont ajout√©s dynamiquement
  setInterval(fixStartButtons, 2000);
  
  console.log("Correction pour le lancement de l'aventure charg√©e");
})();
</script>

<script>
// Remplacement complet de la fonction de d√©marrage
window.startAdventure = function(character) {
  console.log("D√©marrage avec:", character);
  
  // Cacher tous les √©crans pr√©c√©dents
  document.querySelectorAll('.passage').forEach(el => { 
    el.classList.add('hidden');
    el.style.display = 'none';
  });
  
  // Afficher l'√©cran de jeu
  const gameScreen = document.getElementById('game-screen');
  if (gameScreen) {
    gameScreen.classList.remove('hidden');
    gameScreen.style.display = 'block';
  }
  
  // Choisir la destination selon le personnage
  const startLocation = character.toLowerCase() === 'dracula' ? 'portail' : 'allee';
  
  // Utiliser le gestionnaire de sc√®nes pour afficher la bonne sc√®ne
  if (window.sceneManager) {
    window.sceneManager.showScene(startLocation);
  }
};

// Remplacer √©galement la fonction startGame
window.startGame = function(character) {
  window.startAdventure(character);
};
</script>



<div id="portail-passage" class="passage hidden">
    <!-- Contenu du portail -->
</div>

<div id="crypte-dracula-passage" class="passage hidden">
    <!-- Contenu de la crypte -->
</div>


<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log("Initialisation du correctif de narration...");
  
  // Fonction de d√©marrage am√©lior√©e
  window.startGame = window.startAdventure = function(character) {
    console.log("D√©marrage de l'aventure avec:", character);
    
    // Masquer tous les √©crans pr√©c√©dents
    document.querySelectorAll('.passage, .sequence-screen').forEach(el => {
      el.classList.add('hidden');
      el.style.display = 'none';
    });
    
    // Afficher l'√©cran de jeu
    const gameScreen = document.getElementById('game-screen');
    if (gameScreen) {
      gameScreen.classList.remove('hidden');
      gameScreen.style.display = 'block';
    } else {
      console.error("√âcran de jeu non trouv√©!");
      return;
    }
    
    // Mettre √† jour l'√©tat du jeu
    if (!window.gameState) window.gameState = {};
    window.gameState.character = character;
    
    // D√©terminer la location de d√©part et le texte narratif selon le personnage
    let startLocation, backgroundUrl, narrativeText;
    
    if (character.toLowerCase() === 'dracula') {
      startLocation = 'crypte-dracula';
      backgroundUrl = 'https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/7fcd2382286fa36045466ced1230791bfba67aff/img/crypte.jpg';
      narrativeText = "Votre √©tat de comte mort vivant vous soumet √† certaines r√®gles particuli√®res. Les voici : 1) Chaque fois que vous passerez d'un paragraphe √† un autre, vous perdrez 2 POINTS DE VIE, contrairement √† la plupart des autres h√©ros qui, eux, gagnent des POINTS DE VIE en passant d'un paragraphe √† un autre. 2) La s√©ance de spiritisme ne vous concerne pas. Si on vous dit d'y aller, ignorez cette instruction. Ne vous inqui√©tez pas, vous ne manquerez pas grand-chose. 3) Vous ne pouvez pas p√©n√©trer dans un lieu sans y √™tre invit√©. Si on vous propose cette option, ne la choisissez pas √† moins qu'un habitant du lieu ne vous ait explicitement invit√© √† entrer. 4) Vous pouvez passer sous la forme d'une chauve-souris. Cela vous co√ªte 1 PSI...";
    } else {
      startLocation = 'portail';
      backgroundUrl = 'https://raw.githubusercontent.com/brizoss/chateau-dracula-assets/4212d6845a41c07b62959c93f1031dfb97680410/img/porte_du_chateau1.jpg';
      narrativeText = "D'une main soigneusement manucur√©e, vous poussez les hautes grilles en fer forg√© du Ch√¢teau de Dracula. Sans opposer de r√©sistance, elles pivotent sur leurs gonds dans un √©trange silence, troubl√© seulement par le hurlement lointain d'un loup. Devant vous s'√©tend une all√©e orient√©e au nord. Elle vous conduira au manoir d√©moniaque et au monstre qui en est le seigneur.";
    }
    
    // Mettre √† jour l'interface avec les donn√©es du lieu et le texte narratif
    const locationTitle = document.getElementById('location-title');
    const locationDescription = document.getElementById('location-description');
    const choicesContainer = document.getElementById('choices-container');
    
    if (locationTitle && locationDescription && choicesContainer) {
      // Mettre √† jour le titre
      locationTitle.textContent = character.toLowerCase() === 'dracula' ? "Crypte de Dracula" : "Portail du Ch√¢teau";
      
      // Mettre √† jour la description avec le texte narratif personnalis√©
      locationDescription.textContent = narrativeText;
      
      // Vider le conteneur des choix
      choicesContainer.innerHTML = '';
      
      // Ajouter les choix disponibles selon le personnage
      if (character.toLowerCase() === 'dracula') {
        // Choix pour Dracula
        const choices = [
          { text: "Utiliser T√©l√©portation (co√ªte 1 PSI)", action: "usePsiPower" },
          { text: "Examiner le sarcophage", destination: "examiner-sarcophage" },
          { text: "Rechercher un passage secret", action: "searchSecret" }
        ];
        
        choices.forEach(choice => {
          const btn = document.createElement('button');
          btn.className = 'choice';
          btn.textContent = choice.text;
          
          btn.onclick = () => {
            if (choice.destination) {
              window.navigateToLocation(choice.destination);
            } else if (choice.action && typeof window[choice.action] === 'function') {
              window[choice.action]();
            }
          };
          
          choicesContainer.appendChild(btn);
        });
      } else {
        // Choix pour Jonathan
        const choices = [
          { text: "Prendre l'all√©e vers le nord", destination: "allee" },
          { text: "Examiner les alentours", destination: "examiner-portail" },
          { text: "Rechercher un passage secret", action: "searchSecret" }
        ];
        
        choices.forEach(choice => {
          const btn = document.createElement('button');
          btn.className = 'choice';
          btn.textContent = choice.text;
          
          btn.onclick = () => {
            if (choice.destination) {
              window.navigateToLocation(choice.destination);
            } else if (choice.action && typeof window[choice.action] === 'function') {
              window[choice.action]();
            }
          };
          
          choicesContainer.appendChild(btn);
        });
      }
    }
    
    // Mettre √† jour l'image de fond
    const bgElement = document.getElementById('scene-background');
    if (bgElement && backgroundUrl) {
      bgElement.innerHTML = '';
      const img = document.createElement('img');
      img.src = backgroundUrl;
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.objectFit = 'cover';
      img.style.opacity = '0.7';
      bgElement.appendChild(img);
    }
    
    console.log("Aventure d√©marr√©e avec succ√®s pour:", character);
  };
  
  // Assurez-vous que les boutons de continuation sont correctement configur√©s
  function fixContinueButtons() {
    console.log("Correction des boutons Continuer...");
    
    // Bouton Jonathan
    const jonathanContinueBtn = document.getElementById('Jonathan-continue');
    if (jonathanContinueBtn) {
      jonathanContinueBtn.onclick = function() {
        window.startGame('jonathan');
      };
    }
    
    // Bouton Dracula
    const draculaContinueBtn = document.getElementById('dracula-continue');
    if (draculaContinueBtn) {
      draculaContinueBtn.onclick = function() {
        window.startGame('dracula');
      };
    }
  }
  
  // Correction des boutons de d√©marrage apr√®s un court d√©lai
  setTimeout(fixContinueButtons, 1000);
});
</script>
</body>
</html>

